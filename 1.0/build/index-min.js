/*! switchable - v1.0 - 2013-07-21 11:31:53 AM
* Copyright (c) 2013 xuejia.cxj; Licensed  */
KISSY.add("/kissy-gallery/switchable/1.0/build/index",function(a,b,c,d,e,f){function g(c){var d=this;return d instanceof g?(d.container=c.container,1!==d.container[0].nodeType?(a.error("no container found!"),void 0):(d.content=b.get(c.containerCls,d.container),d.content?(d.panels=b.query("li",d.content),d.panels&&0!==d.panels.length&&(d.length=d.panels.length,d.activeIndex=c.activeIndex||0,g.superclass.constructor.apply(this,arguments),this._init()),void 0):(a.error("no content found!"),void 0))):new g(c)}var h,i,j,k,l,m="kissy-switchable-",n=m+"panel-internal",o="switch";return i={DELAY:"",EASING:"easeOutStrong",EFFECT:"scrolly",DURATION:.2,INTERVAL:3},j={container:"",contentCls:"news-items",panels:[],activeIndex:0,effect:"scrolly",easing:"easeOutStrong",interval:3,duration:.2},h={_init:function(){var b=this;b._panelInternalCls=a.guid(n),b._initContent(),b._setAndStartSwitchTimer()},_initContent:function(){var c=this,d=c.container,e=c.content,f=c.panels,g=f[0],h=c.get("effect"),i=b.css(d,"position");if(a.each(f,function(a){b.addClass(a,c._panelInternalCls)}),c.viewSize=[g&&b.outerWidth(g,!0),g&&b.outerHeight(g,!0)],"none"!==h)switch(h){case"scrolly":b.css(e,"position","absolute"),("static"===i||""===i)&&b.css(d,"position","relative")}},prev:function(){var a=this,b=a.activeIndex,c=a.length,d=(b-1+c)%a;a._switchTo(d)},next:function(){var a=this,b=a.activeIndex,c=a.length,d=(b+1)%c;a._switchTo(d)},_switchTo:function(a){var b=this,c=b.activeIndex;b.activeIndex=a,b._switchView(c,a,function(){})},_switchView:function(b,c,d){var e=this,f=e.get("effect"),g=a.isFunction(f)?f:k[f];g.call(e,b,c,function(){e._fireOnSwitch({},b,c),d&&d.call(e)})},_fireOnSwitch:function(b,c,d){var e=this;e.fire(o,a.merge(b,{fromIndex:c,toIndex:d}))},_cancelSwitchTimer:function(){var a=this;a.switchTimer&&(a.switchTimer.cancel(),a.switchTimer=void 0)},_setAndStartSwitchTimer:function(){var b=this;b.switchTimer&&b._cancelSwitchTimer(),b.switchTimer=a.later(function(){g.isElInViewPort(b.container)&&this.next()},1e3*b.get("interval"),!0,b)}},k={scrolly:function(a,c,e){var f=this,g=f.viewSize[1]*f.activeIndex,h={top:-g+"px"};f.anim&&f.anim.stop(),a>-1?f.anim=new d(f.content,h,f.get("duration"),f.get("easing"),function(){f.anim=void 0,e&&e()}).run():(b.css(f.content,h),e&&e())}},l={isElInViewPort:function(){function a(a){return a._ks_lazy_width?a._ks_lazy_width:a._ks_lazy_width=b.outerWidth(a)}function c(a){return a._ks_lazy_height?a._ks_lazy_height:a._ks_lazy_height=b.outerHeight(a)}function d(a,b){var c={};return c.top=Math.max(a.top,b.top),c.bottom=Math.min(a.bottom,b.bottom),c.left=Math.max(a.left,b.left),c.right=Math.min(a.right,b.right),c.bottom>=c.top&&c.right>=c.left}function e(a){var c,d,e,f;if(void 0!==a){c=b.outerHeight(a),d=b.outerWidth(a);var g=b.offset(a);e=g.left,f=g.top}else c=b.viewportHeight(),d=b.viewportWidth(),e=b.scrollLeft(),f=b.scrollTop();var h=e+d,i=f+c;return{left:e,top:f,right:h,bottom:i}}function f(f,g,h){if("none"===b.attr(f,"display"))return!1;h=h||e(),containerRegion=e(g)||h;var i,j=b.offset(f),k=!0,l=j.left,m=j.top,n={left:l,top:m,right:l+a(f),bottom:m+c(f)};return i=d(h,n),i&&containerRegion&&(k=d(containerRegion,n)),k&&i}return f}()},a.extend(g,f,h,{ConfigDefault:i,Effects:k,isElInViewPort:l.isElInViewPort,ATTRS:j}),g},{requires:["dom","event","anim","node","base"]});